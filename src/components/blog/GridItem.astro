---
import { Picture } from 'astro:assets';

import { findImage } from '~/utils/images';
import { getPermalink } from '~/utils/permalinks';
import type { BlogPost } from '~/types/BlogPost';

interface Props {
	post: BlogPost;
}

const { post } = Astro.props;

const image = await findImage(post.image);
---

<article class="group mb-6 transition-all duration-300 hover:-translate-y-1">
	<a href={getPermalink(post.slug, 'post')} class="block">
		<div
			class="relative mb-6 h-0 overflow-hidden rounded-xl bg-gray-400 pb-[56.25%] shadow-lg transition-shadow duration-300 group-hover:shadow-xl dark:bg-slate-700 lg:h-64"
		>
			{
				image && (
					<Picture
						src={image}
						class="absolute inset-0 h-full w-full transform rounded-xl bg-gray-400 object-cover transition-transform duration-500 ease-out group-hover:scale-105 dark:bg-slate-700"
						widths={[400, 900]}
						sizes="(max-width: 900px) 400px, 900px"
						alt={post.title}
					/>
				)
			}
			<!-- Overlay on hover -->
			<div
				class="absolute inset-0 rounded-xl bg-gradient-to-t from-black/60 via-transparent to-transparent opacity-0 transition-opacity duration-300 group-hover:opacity-100"
			>
			</div>
			<!-- Read more indicator -->
			<div
				class="absolute bottom-4 left-4 right-4 translate-y-4 transform opacity-0 transition-all duration-300 group-hover:translate-y-0 group-hover:opacity-100"
			>
				<span class="inline-flex items-center gap-2 text-sm font-semibold text-white">
					阅读更多
					<svg
						class="h-4 w-4 transform transition-transform group-hover:translate-x-1"
						fill="none"
						stroke="currentColor"
						viewBox="0 0 24 24"
					>
						<path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M17 8l4 4m0 0l-4 4m4-4H3"></path>
					</svg>
				</span>
			</div>
		</div>
	</a>
	<h3 class="font-heading mb-2 text-xl font-bold leading-snug sm:text-2xl">
		<a
			href={getPermalink(post.slug, 'post')}
			class="text-slate-900 transition-colors duration-200 hover:text-primary-600 dark:text-white dark:hover:text-primary-400"
		>
			{post.title}
		</a>
	</h3>
	<p class="line-clamp-2 text-gray-700 dark:text-gray-400">{post.excerpt || post.description}</p>
</article>
