---
import { SITE } from '~/config';
import { getCanonical, getPermalink } from '~/utils/permalinks';
import Layout from '~/layouts/PageLayout.astro';
import ImageUpload from '~/components/forms/ImageUpload.astro';

const meta = {
	title: '图片上传示例 | ' + SITE.title,
	description: '演示如何使用图片上传功能',
	canonical: getCanonical(getPermalink('/upload-demo')),
};
---

<Layout {meta}>
	<!-- 页面标题区域 -->
	<section class="bg-gradient-dark py-20">
		<div class="max-w-6xl mx-auto px-4 sm:px-6">
			<div class="text-center">
				<h1
					class="text-5xl md:text-6xl font-bold text-white mb-6 font-display"
					data-aos="fade-up"
				>
					图片上传示例
				</h1>
				<p
					class="text-xl text-gray-300 max-w-3xl mx-auto"
					data-aos="fade-up"
					data-aos-delay="200"
				>
					演示如何使用图片上传功能
				</p>
			</div>
		</div>
	</section>

	<!-- 上传组件区域 -->
	<section class="py-16 bg-white dark:bg-slate-900">
		<div class="max-w-4xl mx-auto px-4 sm:px-6">
			<div class="mb-12">
				<h2 class="text-3xl font-bold mb-4">中文版本</h2>
				<ImageUpload lang="zh" onUploadComplete="handleUploadComplete" />
			</div>

			<div class="border-t border-gray-200 dark:border-gray-700 my-12"></div>

			<div class="mb-12">
				<h2 class="text-3xl font-bold mb-4">English Version</h2>
				<ImageUpload lang="en" onUploadComplete="handleUploadComplete" />
			</div>
		</div>
	</section>

	<!-- 使用说明区域 -->
	<section class="py-16 bg-gray-50 dark:bg-slate-800">
		<div class="max-w-4xl mx-auto px-4 sm:px-6">
			<h2 class="text-3xl font-bold mb-8">使用说明</h2>

			<div class="space-y-6">
				<div class="bg-white dark:bg-slate-900 p-6 rounded-lg shadow">
					<h3 class="text-xl font-semibold mb-3">1. 配置 Cloudinary</h3>
					<p class="text-gray-600 dark:text-gray-300 mb-3">
						首先需要在 <code class="bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded"
							>.env</code
						> 文件中配置 Cloudinary 凭证：
					</p>
					<pre
						class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto"><code>CLOUDINARY_CLOUD_NAME=your_cloud_name
CLOUDINARY_API_KEY=your_api_key
CLOUDINARY_API_SECRET=your_api_secret</code></pre>
					<p class="text-sm text-gray-500 dark:text-gray-400 mt-2">
						访问 <a
							href="https://console.cloudinary.com/"
							target="_blank"
							class="text-blue-600 hover:underline">Cloudinary 控制台</a
						> 获取这些值
					</p>
				</div>

				<div class="bg-white dark:bg-slate-900 p-6 rounded-lg shadow">
					<h3 class="text-xl font-semibold mb-3">2. 在页面中使用组件</h3>
					<pre
						class="bg-gray-900 text-gray-100 p-4 rounded-lg overflow-x-auto"><code>---
import ImageUpload from '~/components/forms/ImageUpload.astro';
---

&lt;ImageUpload lang="zh" onUploadComplete="handleUploadComplete" /&gt;

&lt;script&gt;
  function handleUploadComplete(url: string) &#123;
    console.log('上传完成:', url);
    // 在这里处理上传完成后的逻辑
  &#125;
&lt;/script&gt;</code></pre>
				</div>

				<div class="bg-white dark:bg-slate-900 p-6 rounded-lg shadow">
					<h3 class="text-xl font-semibold mb-3">3. 组件属性</h3>
					<ul class="space-y-2 text-gray-600 dark:text-gray-300">
						<li>
							<code class="bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded">lang</code>: 语言设置
							(可选: 'en' | 'zh', 默认: 'en')
						</li>
						<li>
							<code class="bg-gray-100 dark:bg-gray-800 px-2 py-1 rounded"
								>onUploadComplete</code
							>: 上传完成回调函数名 (可选)
						</li>
					</ul>
				</div>

				<div class="bg-white dark:bg-slate-900 p-6 rounded-lg shadow">
					<h3 class="text-xl font-semibold mb-3">4. 文件限制</h3>
					<ul class="space-y-2 text-gray-600 dark:text-gray-300">
						<li>• 最大文件大小: 10MB</li>
						<li>• 支持格式: JPEG, PNG, GIF, WebP</li>
						<li>• 自动上传到 Cloudinary 的 website-uploads 文件夹</li>
					</ul>
				</div>
			</div>
		</div>
	</section>
</Layout>

<script>
	// 全局回调函数示例
	declare global {
		interface Window {
			handleUploadComplete: (url: string) => void;
		}
	}

	window.handleUploadComplete = function (url: string) {
		console.log('图片上传完成:', url);
		// 你可以在这里添加自定义逻辑
		// 例如: 更新表单字段、显示通知等
	};
</script>
